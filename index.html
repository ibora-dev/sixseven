<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>67</title>
  <style>
    /* ===========================
       6 7 6 7 6 7 6 7 6 7 6 7
       =========================== */
    :root{
      --bg: #050208;
      --fg: #ffd7ff;
      --hot: #ff4fd8;
      --cold:#7c7cff;
      --acid:#5cffb1;
      --shadow: rgba(255,79,216,.15);
      --shadow2: rgba(124,124,255,.10);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --blur: 18px;
      --glow: 0 0 20px var(--shadow), 0 0 80px var(--shadow2);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 800px at 10% 10%, rgba(255,79,216,.10), transparent 55%),
        radial-gradient(900px 700px at 90% 30%, rgba(124,124,255,.10), transparent 55%),
        radial-gradient(1000px 900px at 40% 110%, rgba(92,255,177,.08), transparent 55%),
        linear-gradient(180deg, #050208, #020106 60%, #000);
      color:var(--fg);
      font-family:var(--sans);
      overflow:hidden;
      user-select:none;
    }

    /* Background grain */
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='.25'/%3E%3C/svg%3E");
      mix-blend-mode:overlay;
      opacity:.18;
      transform:scale(1.2);
    }

    /* Layout */
    .wrap{
      position:relative;
      height:100%;
      display:grid;
      grid-template-rows:auto 1fr auto;
      gap:12px;
      padding:14px;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 14px;
      border-radius:var(--radius);
      background:rgba(10,5,14,.55);
      backdrop-filter: blur(var(--blur));
      box-shadow: var(--glow);
      border:1px solid rgba(255,255,255,.06);
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 260px;
    }
    .logo{
      width:46px; height:46px;
      border-radius:14px;
      background:
        radial-gradient(circle at 30% 35%, rgba(255,79,216,.65), transparent 55%),
        radial-gradient(circle at 70% 65%, rgba(124,124,255,.55), transparent 55%),
        radial-gradient(circle at 50% 50%, rgba(92,255,177,.25), transparent 60%),
        linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 0 24px rgba(255,79,216,.20);
      position:relative;
      overflow:hidden;
    }
    .logo::after{
      content:"67";
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      font-family:var(--mono);
      font-weight:900;
      letter-spacing:.08em;
      font-size:18px;
      color:rgba(255,255,255,.88);
      text-shadow: 0 0 10px rgba(255,79,216,.6);
      animation: wobble 2.1s ease-in-out infinite;
    }
    @keyframes wobble{
      0%,100%{transform:translateY(0) rotate(0deg)}
      50%{transform:translateY(-1px) rotate(-1deg)}
    }

    .title{
      line-height:1.05;
    }
    .title h1{
      margin:0;
      font-size:16px;
      letter-spacing:.12em;
      font-weight:900;
      text-transform:uppercase;
      color:rgba(255,255,255,.88);
    }
    .title p{
      margin:4px 0 0;
      font-size:12px;
      color:rgba(255,255,255,.55);
      font-family:var(--mono);
    }

    .hud{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .pill{
      padding:8px 10px;
      border-radius:999px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.08);
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.70);
      display:flex;
      align-items:center;
      gap:8px;
      box-shadow: 0 0 14px rgba(255,79,216,.08);
    }
    .dot{
      width:8px; height:8px;
      border-radius:50%;
      background:var(--hot);
      box-shadow: 0 0 12px rgba(255,79,216,.8);
      animation: pulse 1.2s infinite;
    }
    @keyframes pulse{
      0%,100%{transform:scale(.85); opacity:.7}
      50%{transform:scale(1.25); opacity:1}
    }

    .btnrow{
      display:flex; gap:8px; flex-wrap:wrap;
    }
    button{
      cursor:pointer;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.06);
      color:rgba(255,255,255,.85);
      font-family:var(--mono);
      font-weight:800;
      padding:9px 11px;
      border-radius:12px;
      box-shadow: 0 0 16px rgba(124,124,255,.08);
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
      letter-spacing:.08em;
      text-transform:uppercase;
      font-size:12px;
    }
    button:hover{ background:rgba(255,255,255,.09); border-color:rgba(255,255,255,.16) }
    button:active{ transform: translateY(1px) scale(.99); }

    main{
      position:relative;
      border-radius:var(--radius);
      background:rgba(10,5,14,.35);
      border:1px solid rgba(255,255,255,.06);
      box-shadow: var(--glow);
      overflow:hidden;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:12px;
      padding:12px;
      min-height:0;
    }

    .left, .right{
      border-radius:calc(var(--radius) - 6px);
      background:rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.06);
      overflow:hidden;
      position:relative;
      min-height:0;
    }

    .left{
      display:grid;
      grid-template-rows: auto 1fr auto;
    }

    .panelHead{
      padding:12px 12px 10px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), transparent);
      border-bottom:1px solid rgba(255,255,255,.06);
    }

    .panelHead .k{
      font-family:var(--mono);
      font-size:11px;
      opacity:.7;
      letter-spacing:.14em;
      text-transform:uppercase;
    }

    .big67{
      font-family:var(--mono);
      font-weight:900;
      font-size:44px;
      letter-spacing:.02em;
      line-height:1;
      margin:2px 0 0;
      text-shadow: 0 0 30px rgba(255,79,216,.30);
      position:relative;
    }
    .big67 .shadow{
      position:absolute;
      left:0; top:0;
      transform: translate(2px, 2px);
      opacity:.25;
      filter: blur(.3px);
      color: var(--cold);
      mix-blend-mode:screen;
      pointer-events:none;
    }

    .arena{
      position:relative;
      min-height:0;
      overflow:hidden;
      display:grid;
      place-items:center;
    }

    canvas#c{
      width:100%;
      height:100%;
      display:block;
    }

    .leftFooter{
      padding:10px 12px;
      border-top:1px solid rgba(255,255,255,.06);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background:linear-gradient(0deg, rgba(255,255,255,.05), transparent);
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.70);
    }
    .meter{
      display:flex;
      align-items:center;
      gap:10px;
      width:min(360px, 60%);
    }
    .bar{
      flex:1;
      height:10px;
      border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.08);
      overflow:hidden;
    }
    .fill{
      height:100%;
      width:67%;
      background: linear-gradient(90deg, rgba(255,79,216,.75), rgba(124,124,255,.65), rgba(92,255,177,.55));
      filter:saturate(1.2);
      box-shadow: 0 0 20px rgba(255,79,216,.25);
      transform-origin:left;
      animation: breathe 2.3s ease-in-out infinite;
    }
    @keyframes breathe{
      0%,100%{transform:scaleX(.42)}
      50%{transform:scaleX(1)}
    }

    .right{
      display:grid;
      grid-template-rows: auto 1fr auto;
      min-height:0;
    }

    .console{
      padding:12px;
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.80);
      min-height:0;
      overflow:auto;
      line-height:1.35;
    }
    .line{
      padding:4px 6px;
      border-radius:10px;
      margin-bottom:6px;
      background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.05);
      white-space:pre-wrap;
      word-break:break-word;
    }
    .line b{ color: rgba(255,255,255,.92) }
    .line i{ color: rgba(92,255,177,.9) }
    .line em{ color: rgba(255,79,216,.95); font-style:normal }
    .line u{ color: rgba(124,124,255,.95); text-decoration:none }

    .rightFooter{
      border-top:1px solid rgba(255,255,255,.06);
      padding:10px 12px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      background:linear-gradient(0deg, rgba(255,255,255,.05), transparent);
    }

    .inputWrap{
      display:flex;
      gap:8px;
      align-items:center;
      flex:1;
      min-width:220px;
    }
    input{
      flex:1;
      min-width:140px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.25);
      color:rgba(255,255,255,.86);
      font-family:var(--mono);
      outline:none;
      box-shadow: 0 0 14px rgba(255,79,216,.08);
    }
    input::placeholder{ color:rgba(255,255,255,.35) }
    input:focus{ border-color:rgba(255,79,216,.35) }

    footer{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 14px;
      border-radius:var(--radius);
      background:rgba(10,5,14,.55);
      backdrop-filter: blur(var(--blur));
      border:1px solid rgba(255,255,255,.06);
      box-shadow: var(--glow);
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.62);
    }

    .tiny{
      opacity:.7;
    }
    .keys{
      display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end;
    }
    .key{
      padding:6px 8px;
      border-radius:10px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.08);
    }

    /* Overlays / absurd effects */
    .overlay{
      position:fixed;
      inset:0;
      pointer-events:none;
      opacity:0;
      transition: opacity .25s ease;
      background:
        repeating-linear-gradient(
          90deg,
          rgba(255,79,216,.08) 0 3px,
          rgba(124,124,255,.05) 3px 6px,
          rgba(92,255,177,.04) 6px 9px,
          transparent 9px 18px
        );
      mix-blend-mode:screen;
      filter: blur(.6px);
    }
    .overlay.on{ opacity:1; }

    .toast{
      position:fixed;
      left:14px;
      bottom:14px;
      padding:10px 12px;
      border-radius:14px;
      background:rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 0 24px rgba(255,79,216,.18);
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.85);
      transform: translateY(20px);
      opacity:0;
      transition: .25s ease;
      pointer-events:none;
      max-width:min(520px, calc(100vw - 28px));
      line-height:1.3;
    }
    .toast.show{
      transform: translateY(0);
      opacity:1;
    }

    /* Modal */
    .modal{
      position:fixed;
      inset:0;
      display:none;
      place-items:center;
      background:rgba(0,0,0,.55);
      backdrop-filter: blur(8px);
      z-index:50;
      padding:14px;
    }
    .modal.on{ display:grid; }
    .card{
      width:min(720px, 100%);
      border-radius:22px;
      background:rgba(10,5,14,.72);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 0 80px rgba(255,79,216,.18);
      overflow:hidden;
    }
    .card header{
      border-radius:0;
      box-shadow:none;
      background:rgba(255,255,255,.04);
      border:none;
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .card .body{
      padding:14px;
      font-family:var(--mono);
      font-size:13px;
      color:rgba(255,255,255,.80);
      line-height:1.45;
    }
    .grid67{
      display:grid;
      grid-template-columns: repeat(7, 1fr);
      gap:8px;
      margin-top:12px;
    }
    .tile67{
      height:50px;
      border-radius:14px;
      display:grid;
      place-items:center;
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      font-weight:900;
      letter-spacing:.06em;
      box-shadow: 0 0 16px rgba(124,124,255,.08);
      position:relative;
      overflow:hidden;
    }
    .tile67::after{
      content:"67";
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      opacity:.15;
      font-size:32px;
      transform: rotate(-9deg);
    }

    /* Responsive */
    @media (max-width: 980px){
      main{ grid-template-columns:1fr; }
      .brand{ min-width:auto; }
      .meter{ width:100%; }
    }
  </style>
</head>
<body>
  <div class="overlay" id="overlay"></div>
  <div class="toast" id="toast">67</div>

  <div class="modal" id="modal">
    <div class="card">
      <header>
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div class="title">
            <h1>67</h1>
            <p>six seven six seven six seven</p>
          </div>
        </div>
        <div class="hud">
          <div class="pill"><span class="dot"></span><span>67</span></div>
          <div class="btnrow">
            <button id="closeModal">67</button>
          </div>
        </div>
      </header>
      <div class="body">
        <div><b>R√®gles officielles :</b> 67. 67. 67.</div>
        <div class="tiny" style="margin-top:8px; opacity:.75;">
          Appuie sur <b>6</b> et <b>7</b. Clique partout. Parle √† la console. Ne demande rien. Ne comprends rien.
        </div>
        <div class="grid67" id="grid67"></div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="title">
          <h1>67</h1>
          <p id="subtitle">67 67 67 67 67 67 67</p>
        </div>
      </div>

      <div class="hud">
        <div class="pill"><span class="dot"></span><span id="status">67</span></div>
        <div class="pill"><span>üß™</span><span id="counter">67</span></div>
        <div class="pill"><span>üåÄ</span><span id="phase">67</span></div>
        <div class="btnrow">
          <button id="btnRituel">rituel 67</button>
          <button id="btnGlitch">glitch 67</button>
          <button id="btnPluie">pluie 67</button>
          <button id="btnOracle">oracle 67</button>
          <button id="btnReset">reset 67</button>
        </div>
      </div>
    </header>

    <main>
      <section class="left">
        <div class="panelHead">
          <div>
            <div class="k">arena</div>
            <div class="big67" aria-label="67">
              <span class="shadow">67</span>
              <span>67</span>
            </div>
          </div>
          <div class="pill" title="Tu ne peux pas l'√©teindre.">
            <span>üéõÔ∏è</span>
            <span id="mode">67</span>
          </div>
        </div>

        <div class="arena">
          <canvas id="c"></canvas>
        </div>

        <div class="leftFooter">
          <div class="meter" title="67m√®tre">
            <span>67</span>
            <div class="bar"><div class="fill" id="fill"></div></div>
            <span id="meterValue">67%</span>
          </div>
          <div class="tiny" id="hint">6 + 7 = 67 (presque)</div>
        </div>
      </section>

      <section class="right">
        <div class="panelHead">
          <div>
            <div class="k">console sacr√©e</div>
            <div class="tiny">tape <b>67</b> ou <b>6</b> ou <b>7</b> ou rien. c‚Äôest pareil.</div>
          </div>
          <div class="pill"><span>üìú</span><span id="logCount">67</span></div>
        </div>

        <div class="console" id="console"></div>

        <div class="rightFooter">
          <div class="inputWrap">
            <input id="cmd" placeholder="67" autocomplete="off" />
            <button id="send">67</button>
          </div>
          <div class="btnrow">
            <button id="btnSpam">spam 67</button>
            <button id="btnSilence">silence 67</button>
            <button id="btnModal">manuel 67</button>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <div class="tiny" id="footerLeft">67</div>
      <div class="keys">
        <div class="key">6</div>
        <div class="key">7</div>
        <div class="key">click</div>
        <div class="key">drag</div>
        <div class="key">???</div>
      </div>
    </footer>
  </div>

  <script>
    // ===========================
    //            67
    // ===========================
    (() => {
      // Helpers
      const $ = (s, r=document) => r.querySelector(s);
      const $$ = (s, r=document) => [...r.querySelectorAll(s)];
      const clamp = (n,a,b)=>Math.max(a,Math.min(b,n));
      const now = ()=>performance.now();
      const rand = (a=0,b=1)=>a+Math.random()*(b-a);
      const pick = (arr)=>arr[(Math.random()*arr.length)|0];

      // Elements
      const overlay = $("#overlay");
      const toast = $("#toast");
      const consoleEl = $("#console");
      const cmd = $("#cmd");
      const send = $("#send");
      const counterEl = $("#counter");
      const phaseEl = $("#phase");
      const statusEl = $("#status");
      const modeEl = $("#mode");
      const subtitle = $("#subtitle");
      const meterValue = $("#meterValue");
      const fill = $("#fill");
      const hint = $("#hint");
      const footerLeft = $("#footerLeft");
      const logCount = $("#logCount");

      const modal = $("#modal");
      const closeModal = $("#closeModal");
      const btnModal = $("#btnModal");

      // Buttons
      const btnRituel = $("#btnRituel");
      const btnGlitch = $("#btnGlitch");
      const btnPluie = $("#btnPluie");
      const btnOracle = $("#btnOracle");
      const btnReset = $("#btnReset");
      const btnSpam = $("#btnSpam");
      const btnSilence = $("#btnSilence");

      // Modal grid
      const grid67 = $("#grid67");
      for(let i=0;i<49;i++){
        const d=document.createElement("div");
        d.className="tile67";
        d.textContent = (i%2===0) ? "67" : "67";
        grid67.appendChild(d);
      }

      // State
      const S = {
        count: 67,
        phase: 67,
        mode: 67,
        silence:false,
        rain:false,
        glitch:false,
        ritual:false,
        oracle:false,
        lastToast:0,
        log:0,
        seed: (Math.random()*1e9)|0,
        secret: 67,
        key6:0,
        key7:0,
        lastKey: "",
        meter: 67,
        drift: 0,
        gravity: 0.067,
        drag: 0.67,
        swirl: 0.67,
      };

      // Text generators (only 67 vibes)
      const WORDS = [
        "67","six","seven","6","7","67 67","six seven","seven six","6 7","67."
      ];
      const ORACLE = [
        "67",
        "67 67",
        "six seven",
        "seven six",
        "6‚Ä¶7‚Ä¶",
        "67 (oui)",
        "67 (non)",
        "67 (peut-√™tre)",
        "67 (toujours)",
        "67 (jamais)",
        "67 (67)",
      ];

      const HINTS = [
        "Appuie sur 6. Puis 7. Puis oublie.",
        "Clique au hasard. Tr√®s important : sans raison.",
        "Tape 67 dans la console (ou pas).",
        "Le 67m√®tre ment mais avec charisme.",
        "Ta logique n‚Äôa pas de droits ici.",
        "Six seven. Seven six. 67.",
        "Fais glisser la souris comme si c‚Äô√©tait 67.",
      ];

      function make67(len=67){
        // produce string made of 6 and 7, mostly 67
        let out="";
        for(let i=0;i<len;i++){
          out += (Math.random()<0.67) ? "67" : (Math.random()<0.5 ? "6":"7");
          if(Math.random()<0.2) out += " ";
          if(Math.random()<0.06) out += "\n";
        }
        return out.trim();
      }

      function logLine(html){
        if(S.silence) return;
        const div=document.createElement("div");
        div.className="line";
        div.innerHTML = html;
        consoleEl.appendChild(div);
        S.log++;
        logCount.textContent = String(67 + (S.log % 670));
        consoleEl.scrollTop = consoleEl.scrollHeight;
      }

      function toast67(msg="67"){
        const t=now();
        if(t - S.lastToast < 120) return;
        S.lastToast = t;
        toast.textContent = msg;
        toast.classList.add("show");
        setTimeout(()=>toast.classList.remove("show"), 900);
      }

      function setTitlePulse(){
        let t=0;
        setInterval(()=>{
          t++;
          const a = "67".repeat( (t%7)+1 );
          document.title = a.slice(0,67);
        }, 670);
      }

      function updateHUD(){
        counterEl.textContent = String(S.count);
        phaseEl.textContent = String(S.phase);
        statusEl.textContent = S.glitch ? "67‚ö†" : "67";
        modeEl.textContent = S.rain ? "67‚òî" : (S.ritual ? "67üïØ" : (S.oracle ? "67üîÆ" : "67"));
        subtitle.textContent = make67(67).replace(/\n/g," ");
        hint.textContent = pick(HINTS);
        footerLeft.textContent = pick(WORDS) + " " + pick(WORDS) + " " + pick(WORDS);
        S.meter = clamp(S.meter + rand(-6.7, 6.7), 0, 100);
        meterValue.textContent = Math.round(S.meter) + "%";
        fill.style.width = clamp(S.meter,0,100) + "%";
      }

      function bump(n=1){
        S.count += n;
        if(S.count > 67000) S.count = 67;
        if(S.count < -67000) S.count = 67;
        updateHUD();
      }

      function phaseShift(){
        // phase always returns to 67 in a very untrustworthy way
        const wob = Math.sin(now()/670) * 6.7;
        S.phase = Math.round(67 + wob);
        if(Math.random()<0.067) S.phase = 67;
        updateHUD();
      }

      // Glitch overlay toggle
      function setOverlay(on){
        overlay.classList.toggle("on", !!on);
      }

      // ======= Absurd commands (but still only 67) =======
      function handleCommand(raw){
        const t = (raw || "").trim().toLowerCase();
        const normalized = t.replace(/\s+/g," ");
        const is67 = normalized === "" || normalized === "67" || normalized === "6" || normalized === "7" ||
                     normalized.includes("67") || normalized.includes("six") || normalized.includes("seven");

        const stamp = `<b>${"67"}</b>`;
        if(!is67){
          logLine(`${stamp} : <em>67</em>`);
          toast67("67");
          bump(67);
          return;
        }

        // Command effects
        if(normalized === "" ){
          logLine(`${stamp} : <i>${make67(67)}</i>`);
          bump(6);
          return;
        }

        if(normalized === "6"){
          S.key6++;
          logLine(`${stamp} : <u>6</u> ‚Üí 67`);
          bump(6);
          toast67("6");
          return;
        }
        if(normalized === "7"){
          S.key7++;
          logLine(`${stamp} : <u>7</u> ‚Üí 67`);
          bump(7);
          toast67("7");
          return;
        }

        if(normalized === "67"){
          logLine(`${stamp} : <em>${pick(ORACLE)}</em>`);
          bump(67);
          if(Math.random()<0.67) toggleRitual();
          return;
        }

        // keywords
        if(normalized.includes("oracle") || normalized.includes("üîÆ")){
          toggleOracle();
          logLine(`${stamp} : <em>67</em>`);
          return;
        }
        if(normalized.includes("glitch")){
          toggleGlitch();
          logLine(`${stamp} : <em>67</em>`);
          return;
        }
        if(normalized.includes("pluie") || normalized.includes("rain")){
          toggleRain();
          logLine(`${stamp} : <em>67</em>`);
          return;
        }
        if(normalized.includes("rituel") || normalized.includes("ritual")){
          toggleRitual();
          logLine(`${stamp} : <em>67</em>`);
          return;
        }
        if(normalized.includes("reset")){
          reset67();
          logLine(`${stamp} : <em>67</em>`);
          return;
        }

        // default: blessed nonsense
        logLine(`${stamp} : <i>${make67(67)}</i>`);
        bump(67);
      }

      // ======= Toggles =======
      function toggleGlitch(){
        S.glitch = !S.glitch;
        setOverlay(S.glitch);
        toast67(S.glitch ? "67‚ö†" : "67");
        updateHUD();
      }

      function toggleRain(){
        S.rain = !S.rain;
        toast67(S.rain ? "67‚òî" : "67");
        updateHUD();
      }

      function toggleRitual(){
        S.ritual = !S.ritual;
        toast67(S.ritual ? "67üïØ" : "67");
        if(S.ritual){
          logLine(`<b>67</b> : <em>67 67 67</em>`);
          for(let i=0;i<7;i++){
            setTimeout(()=>logLine(`<b>67</b> : <i>${"67 ".repeat(7).trim()}</i>`), i*67);
          }
        }
        updateHUD();
      }

      function toggleOracle(){
        S.oracle = !S.oracle;
        toast67(S.oracle ? "67üîÆ" : "67");
        updateHUD();
      }

      function reset67(){
        Object.assign(S, {
          count:67, phase:67, mode:67, silence:false,
          rain:false, glitch:false, ritual:false, oracle:false,
          lastToast:0, log:0, seed:(Math.random()*1e9)|0,
          secret:67, key6:0, key7:0, lastKey:"",
          meter:67, drift:0
        });
        consoleEl.innerHTML="";
        setOverlay(false);
        toast67("67");
        updateHUD();
        logLine(`<b>67</b> : <em>67</em>`);
      }

      // ======= Canvas madness (67 particles) =======
      const canvas = $("#c");
      const ctx = canvas.getContext("2d", { alpha: true });
      let W=0,H=0, DPR=1;

      function resize(){
        DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        const r = canvas.getBoundingClientRect();
        W = Math.max(1, Math.floor(r.width * DPR));
        H = Math.max(1, Math.floor(r.height * DPR));
        canvas.width = W;
        canvas.height = H;
      }
      window.addEventListener("resize", resize);

      const particles = [];
      function spawn(n=67){
        for(let i=0;i<n;i++){
          particles.push({
            x: rand(0,W),
            y: rand(0,H),
            vx: rand(-0.67,0.67),
            vy: rand(-0.67,0.67),
            s: rand(10, 34) * DPR,
            r: rand(-Math.PI, Math.PI),
            vr: rand(-0.067, 0.067),
            life: rand(670, 1670),
            flip: Math.random()<0.5 ? -1 : 1,
          });
        }
      }

      function drawText67(p, alpha){
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.r);
        ctx.globalAlpha = alpha;
        ctx.font = `${Math.max(10, p.s)}px ${getComputedStyle(document.documentElement).getPropertyValue("--mono")}`;
        ctx.textAlign="center";
        ctx.textBaseline="middle";
        // Always draw 67, but layered for glow
        ctx.fillText("67", 0, 0);
        ctx.restore();
      }

      let mouse = {x:0,y:0, down:false};
      window.addEventListener("pointerdown", (e)=>{mouse.down=true; mouse.x=e.clientX; mouse.y=e.clientY; toast67("67"); bump(7);});
      window.addEventListener("pointerup", ()=>{mouse.down=false;});
      window.addEventListener("pointermove", (e)=>{mouse.x=e.clientX; mouse.y=e.clientY; if(mouse.down){ bump(1); }});

      function tick(){
        phaseShift();

        // Clear with soft fade
        ctx.save();
        ctx.globalAlpha = 0.12;
        ctx.fillStyle = "rgba(0,0,0,1)";
        ctx.fillRect(0,0,W,H);
        ctx.restore();

        // Spawn rain if on
        if(S.rain && particles.length < 670) spawn(7);
        if(!S.rain && particles.length < 120) spawn(1);

        // Determine style (no explicit colors; canvas uses current fillStyle)
        const grad = ctx.createRadialGradient(W*0.2,H*0.2, 0, W*0.2,H*0.2, Math.max(W,H));
        grad.addColorStop(0, "rgba(255,79,216,.85)");
        grad.addColorStop(0.5, "rgba(124,124,255,.72)");
        grad.addColorStop(1, "rgba(92,255,177,.55)");
        ctx.fillStyle = grad;

        // Mouse influence
        const rect = canvas.getBoundingClientRect();
        const mx = (mouse.x - rect.left) * DPR;
        const my = (mouse.y - rect.top) * DPR;

        // Update particles
        for(let i=particles.length-1;i>=0;i--){
          const p=particles[i];
          p.life -= 1;

          // Swirl toward mouse
          const dx = mx - p.x;
          const dy = my - p.y;
          const d = Math.hypot(dx,dy) || 1;
          const pull = (mouse.down ? 0.067 : 0.02) * S.swirl;

          p.vx += (dx/d) * pull * p.flip;
          p.vy += (dy/d) * pull * -p.flip;

          // Ritual gravity distortion
          if(S.ritual){
            p.vy += 0.0067 * DPR;
            p.vx += Math.sin((p.y + now()/10)/67) * 0.002 * DPR;
          }

          // Glitch jitter
          if(S.glitch && Math.random()<0.067){
            p.x += rand(-6.7, 6.7) * DPR;
            p.y += rand(-6.7, 6.7) * DPR;
          }

          // Basic motion
          p.x += p.vx * DPR;
          p.y += p.vy * DPR;
          p.r += p.vr;

          // Drag
          p.vx *= 0.99;
          p.vy *= 0.99;

          // Wrap around edges
          if(p.x < -50) p.x = W+50;
          if(p.x > W+50) p.x = -50;
          if(p.y < -50) p.y = H+50;
          if(p.y > H+50) p.y = -50;

          // Draw with life alpha
          const alpha = clamp(p.life/670, 0, 1);
          drawText67(p, alpha);

          // Kill
          if(p.life <= 0) particles.splice(i,1);
        }

        // Oracle whispers (visual)
        if(S.oracle && Math.random()<0.02){
          toast67(pick(ORACLE));
          logLine(`<b>67</b> : <em>${pick(ORACLE)}</em>`);
        }

        requestAnimationFrame(tick);
      }

      // ======= Key ritual (6 then 7) =======
      window.addEventListener("keydown", (e)=>{
        const k = e.key;
        if(k === "6" || k === "7"){
          S.lastKey = k;
          toast67(k);
          handleCommand(k);
          // secret combo: 6 7 6 7 6 7
          const seq = (S._seq || "") + k;
          S._seq = seq.slice(-6);
          if(S._seq === "676767"){
            toast67("67‚úÖ");
            toggleGlitch();
            toggleRain();
            toggleRitual();
            toggleOracle();
            logLine(`<b>67</b> : <i>${"67 ".repeat(67).trim()}</i>`);
            bump(670);
          }
        }

        if(k === "Enter"){
          handleCommand(cmd.value);
          cmd.value="";
        }

        if(k === "Escape"){
          modal.classList.remove("on");
        }
      });

      // ======= Click chaos =======
      document.addEventListener("click", (e)=>{
        // Avoid triggering when clicking input area only
        const target = e.target;
        const isInput = target === cmd || target === send;
        if(!isInput){
          bump(1);
          if(Math.random()<0.067){
            logLine(`<b>67</b> : <i>${make67(67)}</i>`);
          }
          if(Math.random()<0.02){
            toggleGlitch();
          }
        }
      });

      // ======= UI wiring =======
      send.addEventListener("click", ()=>{
        handleCommand(cmd.value);
        cmd.value="";
        cmd.focus();
      });

      btnGlitch.addEventListener("click", ()=>{ toggleGlitch(); logLine(`<b>67</b> : <em>67</em>`); });
      btnPluie.addEventListener("click", ()=>{ toggleRain(); logLine(`<b>67</b> : <em>67</em>`); });
      btnRituel.addEventListener("click", ()=>{ toggleRitual(); logLine(`<b>67</b> : <em>67</em>`); });
      btnOracle.addEventListener("click", ()=>{ toggleOracle(); logLine(`<b>67</b> : <em>67</em>`); });
      btnReset.addEventListener("click", ()=>{ reset67(); });

      btnSpam.addEventListener("click", ()=>{
        toast67("67");
        for(let i=0;i<7;i++){
          setTimeout(()=>{
            logLine(`<b>67</b> : <i>${make67(67)}</i>`);
            bump(67);
          }, i*67);
        }
      });

      btnSilence.addEventListener("click", ()=>{
        S.silence = !S.silence;
        toast67(S.silence ? "67ü§´" : "67");
        if(!S.silence) logLine(`<b>67</b> : <em>67</em>`);
      });

      btnModal.addEventListener("click", ()=>{
        modal.classList.add("on");
        toast67("67");
      });

      closeModal.addEventListener("click", ()=>{
        modal.classList.remove("on");
        toast67("67");
      });

      modal.addEventListener("click", (e)=>{
        if(e.target === modal){
          modal.classList.remove("on");
          toast67("67");
        }
      });

      // ======= Boot sequence =======
      function boot(){
        resize();
        spawn(67);
        updateHUD();
        setTitlePulse();

        logLine(`<b>67</b> : <em>67</em>`);
        logLine(`<b>67</b> : <i>${"67 ".repeat(7).trim()}</i>`);
        logLine(`<b>67</b> : <u>6</u> <u>7</u>`);
        logLine(`<b>67</b> : <i>${make67(67)}</i>`);
        logLine(`<b>67</b> : <em>67</em>`);

        // micro-interval weirdness
        setInterval(()=>{ if(Math.random()<0.67) updateHUD(); }, 670);
        setInterval(()=>{ if(S.glitch && Math.random()<0.67) bump(7); }, 670);
        setInterval(()=>{ if(S.rain && Math.random()<0.067) spawn(7); }, 670);

        // occasional ‚Äúfake error‚Äù
        setInterval(()=>{
          if(Math.random()<0.067){
            toast67("67‚ö†");
            logLine(`<b>67</b> : <em>67</em>`);
          }
        }, 1670);

        tick();
      }

      boot();
    })();
  </script>
</body>
</html>
